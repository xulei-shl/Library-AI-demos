### **Excel 数据自动合并需求文档**

#### **1. 项目目标**

开发一个 Python 脚本，用于自动将三个源 Excel 文件（位于脚本根目录）`Sheet1` 中的数据，经过清洗、转换和筛选后，合并追加到指定的目标 Excel 文件中。

#### **3. 目标文件**

- **文件路径**: `E:\NextCloud\中心部门\馆藏量与业务统计\2025年度业务统计表.xlsx`
- **操作**: 将处理后的数据追加到此文件的末尾，不覆盖原有数据。

#### **4. 核心处理规则**

在将数据从源文件复制到目标文件的过程中，需要遵循以下规则：

**4.1. 列的映射与对齐**
- **问题**: 源文件的列顺序与目标文件不同，且可能缺少某些列。
- **要求**: 脚本必须根据**列名**（表头）进行匹配，而不是按列的位置复制。以目标文件的列结构为标准，将源数据正确地放入对应的列。如果源文件缺少目标文件中的某些列，则在追加数据时，这些列的值应为空。

**4.2. 特殊列名重命名**
- **文件**: 文件名含有`馆藏业务统计表`的excel
- **要求**: 在处理此文件时，需要将特定的列名进行转换，以匹配目标文件的表头。
  - `移库来源` 应映射到 `上游来源`。
  - `移库去向` 应映射到 `下游去向`。

**4.3. 数据筛选**
- **文件**: 文件名含有`二部`的excel
- **要求**: 只提取特定时间范围内的数据。筛选条件为 `业务时间` 列，仅保留**当年当月**的记录。
  *(注: "当年当月"即代码运行的时间)*

**4.4. 目标列格式转换**
- **列**: `业务时间`
- **要求**: 数据合并到目标文件后，整列的数据格式需要被转换为**文本**。
- **格式**: `YYYY年M月` (例如: `2025年7月`)。
