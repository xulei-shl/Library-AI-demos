### 模块 1：借阅统计分析与可视化卡片模块

该模块是系统的基础，涵盖了从原始借阅数据处理到生成物理推荐卡片的全过程。

- 三层架构映射：
  - 在代码实现中，**“基础设施层”**（Infrastructure Layer）除了提供 SQLite 缓存外，是否使用了通用的配置管理（如读取 `yaml` 文件的类）？
  - **业务逻辑层**中，借阅统计的核心逻辑（如 `groupby` 统计算法）是封装在独立的 `Service` 类中，还是直接在脚本中执行？
- 全链路数据闭环：
  - 当该模块生成“筛选结果 Excel”和“豆瓣结果 Excel”后，**自动化流程**是如何衔接“图书卡片生成模块”的？
  - 生成的 PNG 图片（1200x1400）是如何通过代码逻辑**自动归档**并准备好提供给前端显示的？
- 技术路径选型理由：
  - 代码中采用了 `ThreadPoolExecutor` 进行并发生成，请确认：为什么选择**多线程并发**而非多进程，这与 Playwright 的多浏览器实例隔离是如何配合的？
  - 为什么在数据存储上大量依赖 **Excel/JSON 文件**而非关系型数据库（如 MySQL）？是为了配合离线分析的便捷性吗？

### 模块 2：主题书目推荐（RSS + LLM）模块

该模块基于文章主题进行向量检索与 AI 评选，最终产出“主题卡”。

- 三层架构映射：
  - 该模块在大纲中被描述为 7 层架构。在代码层面，这 7 层是如何归并到**“数据处理-业务逻辑-基础设施”**这三层大框架下的？
  - **“三 Agent 架构”**（初筛、总结、分析）在代码中是如何实现解耦的？它们是否共享同一套 LLM 调用基础设施？
- 全链路数据闭环：
  - **按月聚合存储策略**（YYYY-MM.xlsx）是如何确保在多阶段处理（6 个阶段）中实现“即时保存”和“增量更新”的？
  - 该模块产出的“交叉分析报告”和“提及书籍”数据，是通过什么机制同步到模块 3（Web 端）的 `lib/content.ts` 目录下的？
- 技术路径选型理由：
  - 代码中为何选择**“分阶段管道（Pipeline）”设计**（共 6 个阶段）？这种设计如何通过代码实现“阶段解耦”和“失败重试”？
  - 在处理动态网站抓取时，为什么选择 **PlaywrightSiteFetcher** 而不是更轻量的工具？

### 模块 3：可视化 Web 交互模块

该模块是整个系统的前端呈现层，采用现代 Web 技术提供“博物馆级”体验。

- 三层架构映射：
  - 前端代码如何体现**“状态驱动 UI”**？请确认 Zustand 状态管理在架构中属于哪一层（通常属于业务逻辑的视图层状态）？
  - `lib/content.ts` 在代码中扮演了什么角色？它是否充当了前端与底层文件系统数据库之间的**适配器（Adapter）**？
- 全链路数据闭环：
  - Web 端是如何实现 **SSR/SSG 混合模式**的？具体哪些页面（如首页）是静态生成的，哪些是实时读取后端 Excel/JSON 数据的？
  - 图片资源是如何从 Cloudflare R2 存储流向前端 `next/image` 组件进行优化的？
- 技术路径选型理由：
  - 为何选择**“文件系统作为数据库”**的设计？在处理上千条图书推荐数据时，Next.js 的读取性能是如何通过代码优化的（如缓存策略）？
  - 代码中引入 **Framer Motion 和物理引擎**（Canvas.tsx）是为了解决用户体验中的哪些痛点？

### 模块 4：AIBot 智搜系统模块

该模块集成在 Web 端，支持简单检索、深度检索和文档解析。

- 三层架构映射：
  - AIBot 的**“流式处理架构”**（Vercel AI SDK）是如何与后端的 LLM 驱动引擎对接的？
  - 在三层架构中，AIBot 的**“意图分类器”**属于哪一层？它是如何引导请求流向不同检索模式的？
- 全链路数据闭环：
  - **“人在环交互”**（Human-in-the-loop）在代码中是如何实现的？用户编辑的草稿是如何重新进入深度检索逻辑并触发二次检索的？
  - 当用户进行“文档上传分析”时，Markdown 文件在代码中是如何被解析并转化为 Agent 可读取的上下文的？
- 技术路径选型理由：
  - 为什么在深度检索模式中要采用 **6 阶段完整流程**（关键词→搜索→分析→交叉→检索→解读）？这种路径选择对检索精准度有何代码层面的保障？
  - **Server-Sent Events (SSE)** 实现流式推送的技术优势在代码中是如何体现的？（例如如何处理长文本的分段展示）

------

**💡 补充说明：** 以上问题涵盖了各模块的**接口定义、数据同步逻辑以及底层技术实现**。当你阅读代码并回答这些问题后，我们将能够清晰地勾勒出整个系统是如何从“原始借阅数据”出发，经过“AI 深度处理”，最终通过“Web 交互”实现馆藏资源活化的全过程。