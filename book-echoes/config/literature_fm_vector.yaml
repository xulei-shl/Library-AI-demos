# =============================================================================
# 文学情境推荐向量检索配置（增强版）
# Module 8 - Phase 3: 情境主题检索
# =============================================================================

# 数据库配置（SQLite - 读取 literary_tags 表）
database:
  path: "runtime/database/books_history.db"
  table: "literary_tags"

# 向量数据库配置
vector_db:
  type: "chromadb"
  persist_directory: "runtime/vector_db/literature_fm"
  collection_name: "literature_fm_contexts"
  distance_metric: "cosine"  # cosine / l2 / ip

# Embedding 模型配置
embedding:
  provider: "SiliconFlow"
  model: "Qwen/Qwen3-Embedding-8B"
  api_key: "env:ONEAPI_API_KEY"
  base_url: "http://47.103.50.106:3000/v1"
  dimensions: 4096
  batch_size: 50
  max_retries: 3
  timeout: 30
  retry_delay: 2

# BM25 检索配置
bm25:
  enabled: true
  k1: 1.5            # 词频饱和参数 (1.2-2.0)
  b: 0.75            # 长度归一化参数 (0.5-0.75)
  field_weights:     # 字段权重
    title: 2.0
    author: 1.0
    summary: 1.5

# RRF 融合配置
rrf:
  k: 60              # RRF平滑常数 (通常取60)

# 重排序配置（可选）
reranker:
  enabled: false     # 默认关闭
  model: "BAAI/bge-reranker-v2-m3"
  top_k: 50          # 对前50个结果重排序
  device: "cpu"      # cpu / cuda
  batch_size: 32     # 批处理大小

# 检索策略默认值
default:
  use_vector: true
  use_bm25: true
  use_rrf: true
  min_confidence: 0.80
  vector_top_k: 50
  bm25_top_k: 50
  final_top_k: 30

# 输出配置
output:
  output_dir: "runtime/outputs/theme_shelf"
