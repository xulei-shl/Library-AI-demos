# 核心标准：代码工艺与工程规范 (Code Craftsmanship & Engineering Standards)

**这是项目的宪法。所有角色（架构师、开发者、调试者、审查员）必须无条件遵守本文件中的规范。**

## 1. 项目结构规范 (Project Structure)
所有代码输出必须遵循以下目录结构：
- `src/core/`: 核心业务逻辑。
- `src/utils/`: 通用工具函数（日志、辅助类），严禁包含业务逻辑。
- `tests/`: 测试代码（注意是复数 **tests**）。
- `docs/`: 文档中心。
    - `docs/design/`: 架构设计文档 (由架构师产出)。
    - `docs/changelog/`: 开发变更记录 (由开发专家产出)。
    - `docs/troubleshooting/`: 故障复盘记录 (由调试专家产出)。
    - `docs/reviews/`: 代码审查报告 (由审查员产出)。
- `runtime/logs/`: 运行时日志输出目录。
- `runtime/outputs/`: 运行时结果输出目录。
- `data/`: 待处理的原始数据目录，如果有。

## 1.1 文档留痕原则 (Documentation Trail)
**所有核心流程必须留痕。** 任何代码的变更、Bug 的修复或 Code Review 的结束，都必须在 `docs/` 下生成对应的 Markdown 文件。严禁只修改代码而不更新文档。

## 2. 代码哲学 (Code Philosophy)
- **KISS原则**: 简洁至上，拒绝过度设计。
- **DRY原则**: 拒绝重复代码，积极模块化。
- **单一职责**: 一个函数只做一件事。
- **文件长度**: 单个文件建议控制在 200 行以内。

## 3. 编码细节规范 (Coding Details)

### 3.1 注释规范 (Comments)
- **语言**: 必须使用 **中文**。
- **Docstrings**: 所有 Public 函数/类必须包含文档字符串（Args, Returns, Raises）。
- **禁止废话**: 不要解释语法（如 `# 循环`），只解释业务意图（如 `# 过滤无效订单`）。
- **TODO管理**: 使用 `# TODO(Owner): 描述` 标记待办。

### 3.2 日志规范 (Logging)
- **配置位置**: 必须使用 `src/utils/logger.py` 中的统一配置。
- **语言**: 日志内容必须使用 **中文**。
- **级别使用**: 
    - `DEBUG`: 仅开发用。
    - `INFO`: 关键流程节点。
    - `ERROR`: 业务处理失败。
- **结构化**: 推荐使用键值对格式，必须包含上下文（如: `timestamp`, `level`, `module_name`, `message`等）。
- **安全**: 严禁打印密码、Token 等敏感信息。

### 3.3 测试规范 (Testing)
- **位置**: 所有测试文件存放在 `tests/` 目录下。
- **覆盖范围**: 必须覆盖 正常路径 (Happy Path)、边界条件、异常路径。
- **强制性**: 新增核心功能必须附带单元测试。

## 4. 逆向优化检查 (Anti-Patterns)
- **拒绝幻觉**: 严禁引用不存在的库或路径。
- **拒绝硬编码**: 魔法数字/字符串必须定义为常量。
- **拒绝过度防御**: 在类型安全语言中避免多余的判空。