# AI-Sheet：智能表格处理助理 🤖

AI-Sheet 是一款集成了大语言模型（LLM）的智能化桌面应用，旨在将繁琐、重复的电子表格（Excel）操作自动化，显著提升您的数据处理效率。

本应用的设计理念源于现代Excel处理的三种核心路径：通过自然语言生成**公式**、利用AI进行**非结构化文本处理**，以及为复杂任务自动生成并执行**Python脚本**。AI-Sheet将这三种能力整合到一个简洁的图形界面中，让您能轻松应对不同复杂度的数据挑战。

![](https://xulei-pic-1258542021.cos.ap-shanghai.myqcloud.com/mdpic/20250910112956.png)

---

## ✨ 核心功能

| 功能 | 描述 |
| :--- | :--- |
| **✍️ 智能公式生成** | 根据自然语言描述，自动生成精确的Excel公式，适用于各类计算与逻辑判断。 |
| **🚀 LLM 批量处理** | 针对非结构化文本数据，利用AI的理解能力进行批量处理，如信息提取、情感分析、数据分类等。 |
| **🐍 Python 代码自动化** | 将复杂的数据处理需求转化为可执行的Python代码，实现数据清洗、重组和高级分析等自动化工作流。 |
| **📂 多文件与数据管理** | 支持同时上传和管理多个Excel文件及其工作表（Sheet），为跨文件数据处理提供便利。 |
| **⚙️ 可配置性** | 提供模型配置和提示词（Prompt）管理界面，允许用户根据需求灵活调整应用。 |

---

## 🚀 快速上手

请遵循以下步骤完成安装与配置。

### 第 1 步：环境与依赖安装

1.  **下载代码**
    ```bash
    git clone https://github.com/Megrez-A/Library-AI-demos.git
    cd Library-AI-demos/ai-sheet
    ```

2.  **安装依赖**
    在项目根目录下，通过命令行工具执行：
    ```bash
    pip install -r requirements.txt
    ```

3.  **(可选) 优化 Python 代码执行速度（仅限 Windows）**
    为了显著加快应用程序中 Python 代码的执行速度，特别是在 Windows系统上，您可以运行一个设置脚本来准备预安装的包。强烈建议执行此步骤以获得更流畅的体验。    ```bash                                                                                    
        python setup_preinstalled_packages.
    ```        

### 第 2 步：配置大语言模型（LLM）

应用需要连接一个大语言模型（LLM）以提供智能服务。

1.  **运行程序**
    ```bash
    python main.py
    ```

2.  **进行配置**
    - 程序启动后，进入 **"⚙️ 配置管理"** 选项卡。
    - 添加您的AI模型配置，其中 **API Key** 和 **Base URL** 为必需参数。
    - 点击“保存”以完成配置。

### 第 3 步：开始使用

配置完成后，即可开始进行智能化数据处理。

1.  **上传文件**：在 **"📊 多Excel上传"** 选项卡中，点击“添加文件”并选择您的Excel文件。
2.  **选择功能**：根据您的任务需求，切换到对应的功能选项卡（如“🧮 公式生成”）。
3.  **描述需求**：在文本框中输入您的指令。
4.  **执行任务**：点击执行按钮，AI将开始处理您的任务。

---

## 📖 功能详解

### 🧮 智能公式生成与应用

此功能旨在替代手动编写和记忆复杂公式的过程。

**工作流程**：
1.  在 **"📊 多Excel上传"** 选项卡中上传文件并选取数据。
2.  切换到 **"🧮 公式生成"** 选项卡。
3.  在“需求描述”框中输入任务，例如：“检查C列的库存，如果低于50，则标记为‘需要补货’，否则标记为‘库存充足’”。
4.  点击 **“生成公式”**，AI将在右侧生成相应的Excel公式。
5.  您可以在 **"公式批量处理"** 模块中将生成的公式应用到整列数据。

**演示:**

![公式生成演示](docs/assets/公式生成与处理.gif)


### 🚀 LLM 批量处理

此功能主要应对文本理解、信息提取等非结构化数据处理任务。

**工作流程**：
1.  上传文件并选择数据。
2.  在 **"提示词生成"** 选项卡中，结合数据信息和处理需求，生成用于批量处理的提示词（Prompt）。
3.  切换到 **"🤖 LLM处理"** 选项卡。
4.  选择相应的提示词模板，执行批量处理。AI将依据指令，对指定数据列进行逐行分析和处理。

**演示:**

![LLM批量处理演示](docs/assets/大模型处理.mp4)

### 🐍 Python 代码自动化

当公式或简单文本处理无法满足复杂的数据处理需求时，此功能可将您的自然语言需求转化为完整的Python代码并执行。

**工作流程**：
1.  上传文件并选择数据。
2.  切换到 **"🐍 Python代码处理"** 选项卡。
3.  **描述需求**：详细说明您的数据处理任务，例如：“将‘收货地址’列拆分为‘省份’、‘城市’和‘详细地址’三列”。
4.  **分析策略**：点击 **“🔍 分析处理类型”**，AI将分析您的需求，并确定处理策略（例如，是在原数据上新增列，还是生成一个独立的新文件）。
5.  **执行代码**：确认策略无误后，点击 **“✅ 确认并执行Python代码”**。系统会自动生成、测试并优化代码，直至成功执行。
6.  处理完成后，结果将自动保存，并附带一份详细的操作报告（Changelog）和所执行的Python脚本。

**演示:**

![Python代码自动化演示](docs/assets/python批处理.gif)