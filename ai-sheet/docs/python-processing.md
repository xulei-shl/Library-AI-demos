我准备在项目中增加一个新的功能。功能基本描述：`python处理`。也就是：（1）用户在界面中选择需要处理的excel-sheet-列的信息，并输入数据处理需求描述，以及自动合并样例数据组成初始的用户提示词。（2）然后调用大模型编写python脚本（除了提供py代码文件，还需要requirements.txt文件）。（3）编写后自动测试阶段：因为用户已经提供了所需处理列的样例数据，因此编写好代码后自动运行代码根据反馈修复代码或转入下一个流程。（3.1）其中修复代码，也是大模型自动处理，每次调用必须将最开始的初始用户提示词附上，也就是要提供初始需求用户提示词，python代码，错误提示。如果测试正确，则转入正式数据处理：（4）使用用户在（1）中提供真实本地excel，运行最终的python代码，结果保存在指定文件夹。这个指定文件夹已经运行过程中产生的python代码，都保存在这路径，如果是中间调试的错误python代码，则保存在此路径的 changelogs路径下。也就是最开始产生的py文件是在根目录，如果有错误，旧版本py及其错误日志都转移到changelogs中，新版本py存在根目录。（5）最终运行结束后，撰写一份readme.md文档。

 界面：与`公式生成`相同。左右布局，左侧是`excel文件和sheet选择`：2个按钮，一个多行文本框；需求描述，一个多行文本框；【新增】结果保存路径，单行文本框和选择按钮【这个路径就是编写python代码，以及运行结果的保存路径】；生成配置的组件；最底下的按钮。右侧，日志信息显示文本框。清空日志，下载日志按钮。

后端：`excel文件和sheet选择`，需求描述，拼接上multi_excel_preview.md样例数据组成初始用户提示词。生成配置，调用大模型api接口都与`公式生成`基本相同。
最主要变化就是自动运行python进行测试，首先要根据multi_excel_preview.md样例数据进行测试，并根据反馈是迭代修复直至正确，以及最终的正式python数据处理，最终撰写readme.md。

其中运行python因为路径是人工已经选择好的，自动执行就是进入路径，创建虚拟环境，安装依赖，执行代码，根据输出的反馈。如果有错误则提取错误信息，将初始用户提示词，python代码组装为新的提示词，提交给大模型重新输出新版本完整的代码。

我想到的可能需要使用langchain框架？python执行的操作因为是多次执行，是否需要封装为工具？