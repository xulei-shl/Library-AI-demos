# 多Excel多Sheet功能测试用例

## 测试用例概览

| 用例ID | 测试场景 | 预期结果 | 优先级 |
|--------|----------|----------|--------|
| TC001 | 单个Excel文件单个Sheet | 正常加载和预览 | 高 |
| TC002 | 单个Excel文件多个Sheet | 支持多Sheet选择 | 高 |
| TC003 | 多个Excel文件单个Sheet | 支持多文件加载 | 高 |
| TC004 | 多个Excel文件多个Sheet | 完整多文件多Sheet功能 | 高 |
| TC005 | 动态添加删除选择器 | UI操作正常 | 中 |
| TC006 | 大文件处理 | 性能和稳定性 | 中 |
| TC007 | 错误文件处理 | 错误处理机制 | 中 |
| TC008 | 与公式生成Tab集成 | 数据共享正常 | 高 |
| TC009 | 临时文件管理 | 文件保存和清理 | 中 |
| TC010 | 边界条件测试 | 极限情况处理 | 低 |

## 详细测试用例

### TC001: 单个Excel文件单个Sheet
**测试目标**: 验证基本的单文件单Sheet功能

**前置条件**:
- 准备一个包含数据的Excel文件 `test1.xlsx`
- 文件包含至少一个Sheet `Sheet1`
- Sheet中有至少5行数据

**测试步骤**:
1. 启动应用，切换到"多Excel上传"Tab
2. 点击"浏览"按钮，选择 `test1.xlsx`
3. 确认Sheet下拉菜单显示 `Sheet1`
4. 选择 `Sheet1`
5. 查看右侧预览区域

**预期结果**:
- 文件成功加载，Sheet列表正确显示
- 预览区域显示文件名、Sheet名、行数、列数
- 显示前5行数据的Markdown表格
- 信息显示"已选择 1 个文件，1 个Sheet"

**测试数据**:
```
test1.xlsx - Sheet1
| 姓名 | 年龄 | 城市 | 薪资 | 部门 |
|------|------|------|------|------|
| 张三 | 25   | 北京 | 8000 | 技术 |
| 李四 | 30   | 上海 | 12000| 销售 |
| 王五 | 28   | 广州 | 9000 | 市场 |
| 赵六 | 32   | 深圳 | 15000| 技术 |
| 钱七 | 26   | 杭州 | 11000| 产品 |
```

---

### TC002: 单个Excel文件多个Sheet
**测试目标**: 验证单文件多Sheet选择功能

**前置条件**:
- 准备一个Excel文件 `test2.xlsx`
- 文件包含多个Sheet: `员工信息`, `部门信息`, `薪资信息`
- 每个Sheet都有数据

**测试步骤**:
1. 启动应用，切换到"多Excel上传"Tab
2. 选择 `test2.xlsx` 文件
3. 选择 `员工信息` Sheet
4. 点击"➕ 添加"按钮
5. 在新选择器中选择同一文件 `test2.xlsx`
6. 选择 `部门信息` Sheet
7. 再次添加选择器，选择 `薪资信息` Sheet
8. 查看预览

**预期结果**:
- 成功创建3个选择器
- 每个选择器显示不同的Sheet
- 预览区域显示3个Sheet的数据
- 信息显示"已选择 1 个文件，3 个Sheet"

---

### TC003: 多个Excel文件单个Sheet
**测试目标**: 验证多文件单Sheet功能

**前置条件**:
- 准备3个Excel文件: `sales.xlsx`, `products.xlsx`, `customers.xlsx`
- 每个文件都有 `Sheet1`

**测试步骤**:
1. 启动应用，切换到"多Excel上传"Tab
2. 选择 `sales.xlsx` 的 `Sheet1`
3. 添加选择器，选择 `products.xlsx` 的 `Sheet1`
4. 添加选择器，选择 `customers.xlsx` 的 `Sheet1`
5. 查看预览

**预期结果**:
- 成功加载3个不同文件
- 预览显示3个文件的数据
- 信息显示"已选择 3 个文件，3 个Sheet"
- 每个文件的数据独立显示

---

### TC004: 多个Excel文件多个Sheet
**测试目标**: 验证完整的多文件多Sheet功能

**前置条件**:
- 准备2个Excel文件，每个文件有2个Sheet
- `file1.xlsx`: `Data1`, `Data2`
- `file2.xlsx`: `Info1`, `Info2`

**测试步骤**:
1. 选择 `file1.xlsx` 的 `Data1`
2. 添加选择器，选择 `file1.xlsx` 的 `Data2`
3. 添加选择器，选择 `file2.xlsx` 的 `Info1`
4. 添加选择器，选择 `file2.xlsx` 的 `Info2`
5. 查看预览
6. 点击"保存选择"
7. 切换到"公式生成"Tab
8. 检查列选择器和样本数据

**预期结果**:
- 预览显示4个Sheet的数据
- 信息显示"已选择 2 个文件，4 个Sheet"
- 保存成功
- 公式生成Tab中显示所有列信息
- 列格式为 `[文件名-Sheet名] A列-列名`

---

### TC005: 动态添加删除选择器
**测试目标**: 验证选择器的动态管理功能

**测试步骤**:
1. 默认有1个选择器
2. 点击"➕ 添加"按钮5次，创建6个选择器
3. 尝试删除第1个选择器
4. 删除第3个选择器
5. 删除第5个选择器
6. 继续删除直到只剩1个选择器
7. 尝试删除最后一个选择器

**预期结果**:
- 成功创建6个选择器
- 成功删除指定选择器
- 剩余选择器重新排列
- 最后一个选择器无法删除，显示警告信息

---

### TC006: 大文件处理
**测试目标**: 验证大文件的处理能力和性能

**前置条件**:
- 准备一个大Excel文件 `large_file.xlsx` (接近50MB限制)
- 文件包含大量数据行 (>10000行)

**测试步骤**:
1. 选择大文件
2. 观察加载时间
3. 查看预览
4. 检查内存使用情况
5. 尝试添加多个大文件

**预期结果**:
- 文件成功加载（可能需要较长时间）
- 预览正常显示前5行
- 显示数据截取提示（如果超过最大行数限制）
- 系统保持稳定，无崩溃

---

### TC007: 错误文件处理
**测试目标**: 验证错误处理机制

**测试数据**:
- 不存在的文件路径
- 非Excel格式文件 `test.txt`
- 损坏的Excel文件
- 超大文件 (>50MB)
- 空Excel文件
- 密码保护的Excel文件

**测试步骤**:
1. 尝试选择每种错误文件
2. 观察错误提示
3. 确认系统稳定性

**预期结果**:
- 每种错误都有相应的错误提示
- 错误信息清晰明确
- 系统不崩溃，可以继续操作

---

### TC008: 与公式生成Tab集成
**测试目标**: 验证数据共享机制

**前置条件**:
- 在多Excel Tab中选择了多个文件和Sheet
- 已点击"保存选择"

**测试步骤**:
1. 切换到"公式生成"Tab
2. 检查列选择下拉菜单
3. 检查样本数据区域
4. 尝试生成公式
5. 返回多Excel Tab修改选择
6. 再次保存并检查公式生成Tab

**预期结果**:
- 列选择器显示所有选择的列
- 列格式正确: `[文件名-Sheet名] A列-列名`
- 样本数据显示组合预览
- 可以正常生成公式
- 修改选择后数据同步更新

---

### TC009: 临时文件管理
**测试目标**: 验证临时文件的保存和清理

**测试步骤**:
1. 选择多个文件和Sheet
2. 点击"保存选择"
3. 检查 `logs/` 目录下的文件
4. 点击"清除所有"
5. 再次检查 `logs/` 目录
6. 关闭应用
7. 重新启动应用，检查临时文件

**预期结果**:
- 保存后生成临时文件:
  - `multi_excel_preview.md`
  - `multi_excel_selections.json`
- 清除后临时文件被删除
- 应用关闭时自动清理临时文件

---

### TC010: 边界条件测试
**测试目标**: 验证极限情况的处理

**测试场景**:
1. **空文件测试**: 选择空的Excel文件
2. **单列数据**: 只有一列数据的Sheet
3. **单行数据**: 只有标题行的Sheet
4. **特殊字符**: 文件名和Sheet名包含特殊字符
5. **长文件名**: 超长的文件路径和名称
6. **大量选择器**: 创建20+个选择器
7. **重复选择**: 多次选择同一文件和Sheet
8. **快速操作**: 快速添加删除选择器

**预期结果**:
- 空文件显示"数据为空"提示
- 单列/单行数据正常显示
- 特殊字符正确处理和显示
- 长文件名适当截断或换行显示
- 大量选择器不影响性能
- 重复选择正常处理
- 快速操作不导致界面异常

## 测试执行记录模板

### 执行信息
- **测试日期**: ___________
- **测试人员**: ___________
- **测试环境**: ___________
- **应用版本**: ___________

### 测试结果汇总
| 用例ID | 执行结果 | 备注 |
|--------|----------|------|
| TC001  | ☐ 通过 ☐ 失败 |      |
| TC002  | ☐ 通过 ☐ 失败 |      |
| TC003  | ☐ 通过 ☐ 失败 |      |
| TC004  | ☐ 通过 ☐ 失败 |      |
| TC005  | ☐ 通过 ☐ 失败 |      |
| TC006  | ☐ 通过 ☐ 失败 |      |
| TC007  | ☐ 通过 ☐ 失败 |      |
| TC008  | ☐ 通过 ☐ 失败 |      |
| TC009  | ☐ 通过 ☐ 失败 |      |
| TC010  | ☐ 通过 ☐ 失败 |      |

### 问题记录
| 问题ID | 问题描述 | 严重程度 | 状态 |
|--------|----------|----------|------|
|        |          |          |      |

### 测试总结
- **通过率**: ____%
- **主要问题**: 
- **改进建议**: 
- **测试结论**: