# 中国大百科全书 Playwright 爬虫工具

本项目包含两个独立的 Python 脚本，使用 Playwright 库来自动化操作[中国大百科全书](https://www.zgbk.com)网站，分别用于 **搜索条目** 和 **提取特定条目的详细内容**。

## 环境准备

在运行脚本之前，请确保您已安装所需的库。

1.  **安装 Playwright**
    ```bash
    pip install playwright
    ```

2.  **安装浏览器驱动** (首次运行时需要)
    ```bash
    playwright install
    ```

---

## 1. 条目搜索 (`zgbk_search_playwright.py`)

该脚本模拟用户在网站上执行搜索操作，并返回一个包含标题、URL和摘要的搜索结果列表。

### 功能

-   输入一个关键词。
-   自动在网站的搜索框中输入关键词并提交搜索。
-   脚本内置了多种复杂的备用逻辑，以应对网站前端代码的可能变化，确保搜索的稳定性。
-   解析搜索结果页面，提取每条结果的标题、链接和简短摘要。

### 如何使用

通过命令行运行脚本，并使用 `--query` 参数指定您想搜索的关键词。

```bash
python zgbk_search_playwright.py --query "卡尔登大戏院"
```

**常用参数:**

-   `--query` 或 `-q`: 指定要搜索的关键词 (默认为 "卡尔登大戏院")。
-   `--out <文件名>`: 将JSON输出结果保存到指定的文件中。
-   `--headed`: 以“有头”模式运行浏览器，即显示浏览器界面，方便调试。
-   `--timeout <毫秒>`: 设置页面操作的超时时间 (默认为 20000ms)。

### 输出示例

脚本会以JSON格式输出搜索结果：

```json
{
  "query": "卡尔登大戏院",
  "count": 1,
  "results": [
    {
      "title": "卡尔登大戏院",
      "url": "https://www.zgbk.com/ecph/words?SiteID=1&ID=124008",
      "summary": "20世纪二三十年代上海的著名剧场。旧址在今上海市黄浦区黄河路21号。由英籍华人卢根设计……"
    }
  ]
}
```

---

## 2. 条目内容提取 (`zgbk_extract_entry.py`)

该脚本用于访问一个给定的百科条目URL，并从中提取结构化的详细信息，包括基本信息和正文段落。

### 功能

-   接收一个具体的百科条目URL。
-   通过在浏览器环境中执行复杂的JavaScript代码，智能地解析和提取页面内容。
-   **基本信息提取**: 抓取如“英文名称”、“成立时间”、“所属学科”等元数据。
-   **正文提取**: 抓取条目的主要内容段落，并自动过滤掉“相关条目”、“参考文献”、导航栏、页脚等无关部分。
-   对提取的数据进行深度清洗，移除噪声和格式不一致的内容。

### 如何使用

通过命令行运行脚本，并使用 `--url` 参数指定目标条目的URL。

```bash
python zgbk_extract_entry.py --url "https://www.zgbk.com/ecph/words?SiteID=1&ID=124008"
```

**常用参数:**

-   `--url`: 指定要提取内容的条目URL。
-   `--out <文件名>`: 将JSON输出结果保存到指定的文件中。
-   `--headed`: 显示浏览器界面，方便调试。
-   `--timeout <毫秒>`: 设置页面操作的超时时间 (默认为 30000ms)。

### 输出示例

脚本会以JSON格式输出提取的条目信息：

```json
{
  "url": "https://www.zgbk.com/ecph/words?SiteID=1&ID=124008",
  "title": "卡尔登大戏院",
  "basic_info": {
    "英文名称": "Carlton Theatre",
    "成立时间": "1923",
    "成立地点": "中国上海",
    "所属学科": "戏剧"
  },
  "entry_content": [
    "20世纪二三十年代上海的著名剧场。旧址在今上海市黄浦区黄河路21号。由英籍华人卢根设计，外观为仿古典主义风格。1923年建成。观众厅分3层，设1200余个座位。...",
    "卡尔登大戏院建成之初，主要放映西方电影，兼演一些歌舞、魔术等节目。1926年2月5日，上海艺术剧社在此首演丁西林的独幕剧《一只马蜂》和《亲爱的丈夫》，这是中国话剧在上海走向商业性剧场公演的开端。...",
    "（续...）"
  ]
}
```
